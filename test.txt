D:\code\ayan\appoinmentbackend>python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
INFO:     Will watch for changes in these directories: ['D:\\code\\ayan\\appoinmentbackend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [23724] using WatchFiles
INFO:     Started server process [8280]
INFO:     Waiting for application startup.
2025-11-10 16:26:38,621 - app.main - INFO - Application startup complete: project=Appointment360 API version=0.1.0
INFO:     Application startup complete.
2025-11-10 16:27:05,140 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/
2025-11-10 16:27:05,140 - app.api.v1.endpoints.root - INFO - Root endpoint requested: project=Appointment360 API version=0.1.0
2025-11-10 16:27:05,142 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/ HTTP/1.1" 200 OK
2025-11-10 16:27:05,154 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/
2025-11-10 16:27:05,154 - app.api.v1.endpoints.root - INFO - Root endpoint requested: project=Appointment360 API version=0.1.0
2025-11-10 16:27:05,154 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/ HTTP/1.1" 200 OK
2025-11-10 16:27:05,172 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/health/
2025-11-10 16:27:05,172 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/health/ status=404
INFO:     127.0.0.1:62197 - "GET /api/v1/health/ HTTP/1.1" 404 Not Found
2025-11-10 16:27:05,188 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/favicon.ico
2025-11-10 16:27:05,188 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/favicon.ico status=204
INFO:     127.0.0.1:62197 - "GET /favicon.ico HTTP/1.1" 204 No Content
2025-11-10 16:27:05,204 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/
2025-11-10 16:27:05,204 - app.api.v1.endpoints.root - INFO - Root endpoint requested: project=Appointment360 API version=0.1.0
2025-11-10 16:27:05,204 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/ HTTP/1.1" 200 OK
2025-11-10 16:27:05,219 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:05,219 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:27:05,219 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:27:12,368 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:12,376 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:12,392 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/ HTTP/1.1" 200 OK
2025-11-10 16:27:12,433 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:12,444 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:12,448 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:16,678 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:16,741 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:27:16,743 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=1&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:27:17,051 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:17,117 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:17,194 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:18,005 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:18,073 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:27:18,075 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=2&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:27:18,213 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:18,237 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:18,250 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:19,196 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:19,222 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:19,242 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=1&page_size=25 HTTP/1.1" 200 OK
2025-11-10 16:27:19,301 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:19,330 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=50 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:19,338 - app.services.contacts_service - INFO - Service listing contacts: limit=50 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:20,519 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:20,519 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=50 has_next=True has_previous=False
2025-11-10 16:27:20,519 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=1&page_size=50 HTTP/1.1" 200 OK
2025-11-10 16:27:20,543 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:20,543 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=100 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:20,543 - app.services.contacts_service - INFO - Service listing contacts: limit=100 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:21,999 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:22,054 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=100 has_next=True has_previous=False
2025-11-10 16:27:22,110 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=1&page_size=100 HTTP/1.1" 200 OK
2025-11-10 16:27:22,236 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:22,266 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=1 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:22,320 - app.services.contacts_service - INFO - Service listing contacts: limit=1 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:22,831 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:22,863 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=1 has_next=True has_previous=False
2025-11-10 16:27:22,864 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=1&page_size=1 HTTP/1.1" 200 OK
2025-11-10 16:27:22,892 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:22,910 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:22,926 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:27:23,389 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:23,432 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:27:23,452 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?page=999&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:27:23,586 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:23,650 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'first_name']
2025-11-10 16:27:23,667 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'first_name']
2025-11-10 16:27:24,873 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:24,918 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:24,978 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?first_name=ann HTTP/1.1" 200 OK
2025-11-10 16:27:25,191 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:25,206 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'last_name']
2025-11-10 16:27:25,206 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'last_name']
2025-11-10 16:27:26,416 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:26,418 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:26,421 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?last_name=smith HTTP/1.1" 200 OK
2025-11-10 16:27:26,456 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:26,458 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'title']
2025-11-10 16:27:26,458 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'title']
2025-11-10 16:27:27,653 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:27,678 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:27,730 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?title=cto HTTP/1.1" 200 OK
2025-11-10 16:27:27,941 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:27,979 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company', 'distinct']
2025-11-10 16:27:28,047 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company', 'distinct']
2025-11-10 16:27:29,276 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:29,303 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:29,369 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company=tech HTTP/1.1" 200 OK
2025-11-10 16:27:29,476 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:29,504 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_name_for_emails', 'distinct']
2025-11-10 16:27:29,504 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_name_for_emails', 'distinct']
2025-11-10 16:27:30,722 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:30,739 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:30,758 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_name_for_emails=inc HTTP/1.1" 200 OK
2025-11-10 16:27:30,994 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:31,003 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email']
2025-11-10 16:27:31,016 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email']
2025-11-10 16:27:33,559 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:33,603 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:33,627 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?email=%40example.com HTTP/1.1" 200 OK
2025-11-10 16:27:33,773 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:33,788 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['department', 'distinct']
2025-11-10 16:27:33,803 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['department', 'distinct']
2025-11-10 16:27:35,010 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:35,033 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:35,089 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?departments=sales HTTP/1.1" 200 OK
2025-11-10 16:27:35,278 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:35,299 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'work_direct_phone']
2025-11-10 16:27:35,326 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'work_direct_phone']
2025-11-10 16:27:37,264 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:37,280 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:37,295 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?work_direct_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:27:37,418 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:37,439 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'home_phone']
2025-11-10 16:27:37,453 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'home_phone']
2025-11-10 16:27:39,293 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:39,313 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:39,313 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?home_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:27:39,473 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:39,487 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'mobile_phone']
2025-11-10 16:27:39,503 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'mobile_phone']
2025-11-10 16:27:41,468 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:41,488 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:41,492 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?mobile_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:27:41,663 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:41,676 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['corporate_phone', 'distinct']
2025-11-10 16:27:41,684 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['corporate_phone', 'distinct']
2025-11-10 16:27:42,882 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:42,884 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:42,890 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?corporate_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:27:42,961 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:42,963 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'other_phone']
2025-11-10 16:27:42,964 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'other_phone']
2025-11-10 16:27:46,353 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:46,370 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:46,381 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?other_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:27:46,480 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:46,491 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['city', 'distinct']
2025-11-10 16:27:46,504 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['city', 'distinct']
2025-11-10 16:27:47,934 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:47,946 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:47,958 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?city=San HTTP/1.1" 200 OK
2025-11-10 16:27:48,072 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:48,089 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'state']
2025-11-10 16:27:48,104 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'state']
2025-11-10 16:27:49,305 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:49,325 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:49,348 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?state=CA HTTP/1.1" 200 OK
2025-11-10 16:27:49,422 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:49,443 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct']
2025-11-10 16:27:49,469 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct']
2025-11-10 16:27:50,934 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:50,950 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:50,961 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?country=US HTTP/1.1" 200 OK
2025-11-10 16:27:51,056 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:51,067 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'technologies']
2025-11-10 16:27:51,084 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'technologies']
2025-11-10 16:27:52,256 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:52,292 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:52,295 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?technologies=python HTTP/1.1" 200 OK
2025-11-10 16:27:52,462 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:52,478 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'keywords']
2025-11-10 16:27:52,491 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'keywords']
2025-11-10 16:27:53,730 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:53,795 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:53,865 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?keywords=enterprise HTTP/1.1" 200 OK
2025-11-10 16:27:54,059 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:54,079 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'person_linkedin_url']
2025-11-10 16:27:54,112 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'person_linkedin_url']
2025-11-10 16:27:55,380 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:55,398 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:55,411 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?person_linkedin_url=linkedin.com HTTP/1.1" 200 OK
2025-11-10 16:27:55,549 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:55,568 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'website']
2025-11-10 16:27:55,592 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'website']
2025-11-10 16:27:58,431 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:27:58,455 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:27:58,473 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?website=example.com HTTP/1.1" 200 OK
2025-11-10 16:27:58,564 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:27:58,585 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_linkedin_url', 'distinct']
2025-11-10 16:27:58,606 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_linkedin_url', 'distinct']
2025-11-10 16:27:59,794 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:27:59,805 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:27:59,814 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_linkedin_url=linkedin.com HTTP/1.1" 200 OK
2025-11-10 16:27:59,961 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:00,000 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'facebook_url']
2025-11-10 16:28:00,038 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'facebook_url']
2025-11-10 16:28:01,284 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:01,293 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:01,308 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?facebook_url=facebook.com HTTP/1.1" 200 OK
2025-11-10 16:28:01,438 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:01,444 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'twitter_url']
2025-11-10 16:28:01,450 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'twitter_url']
2025-11-10 16:28:02,650 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:02,673 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:02,689 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?twitter_url=twitter.com HTTP/1.1" 200 OK
2025-11-10 16:28:02,846 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:02,864 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_address', 'distinct']
2025-11-10 16:28:02,865 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_address', 'distinct']
2025-11-10 16:28:04,171 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:04,192 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:04,211 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_address=street HTTP/1.1" 200 OK
2025-11-10 16:28:04,299 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:04,310 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_city', 'distinct']
2025-11-10 16:28:04,316 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_city', 'distinct']
2025-11-10 16:28:05,485 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:05,506 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:05,529 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_city=San HTTP/1.1" 200 OK
2025-11-10 16:28:05,654 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:05,660 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_state', 'distinct']
2025-11-10 16:28:05,669 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_state', 'distinct']
2025-11-10 16:28:06,913 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:06,928 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:06,932 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_state=CA HTTP/1.1" 200 OK
2025-11-10 16:28:07,074 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:07,086 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_country', 'distinct']
2025-11-10 16:28:07,098 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_country', 'distinct']
2025-11-10 16:28:08,347 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:08,356 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:08,366 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_country=US HTTP/1.1" 200 OK
2025-11-10 16:28:08,501 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:08,518 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company_phone', 'distinct']
2025-11-10 16:28:08,541 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company_phone', 'distinct']
2025-11-10 16:28:09,473 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:09,481 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:09,496 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?company_phone=555 HTTP/1.1" 200 OK
2025-11-10 16:28:09,602 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:09,622 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'industries']
2025-11-10 16:28:09,637 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'industries']
2025-11-10 16:28:11,277 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:11,310 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:11,314 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?industry=software HTTP/1.1" 200 OK
2025-11-10 16:28:11,519 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:11,538 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:11,577 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:12,529 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:12,540 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:12,543 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?latest_funding=series HTTP/1.1" 200 OK
2025-11-10 16:28:12,645 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:12,652 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:12,661 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:13,360 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:13,384 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:13,387 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?last_raised_at=2024 HTTP/1.1" 200 OK
2025-11-10 16:28:13,505 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:13,524 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email_status']
2025-11-10 16:28:13,538 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email_status']
2025-11-10 16:28:15,711 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:28:15,727 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:28:15,740 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?email_status=valid HTTP/1.1" 200 OK
2025-11-10 16:28:15,917 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:15,939 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:15,966 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:28:17,063 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:17,113 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:17,139 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?primary_email_catch_all_status=yes HTTP/1.1" 200 OK
2025-11-10 16:28:17,326 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:17,337 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'stage']
2025-11-10 16:28:17,348 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'stage']
2025-11-10 16:28:19,583 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:28:19,614 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:28:19,628 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?stage=lead HTTP/1.1" 200 OK
2025-11-10 16:28:19,728 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:19,743 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'seniority']
2025-11-10 16:28:19,767 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'seniority']
2025-11-10 16:28:20,969 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:20,983 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:21,005 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?seniority=director HTTP/1.1" 200 OK
2025-11-10 16:28:21,149 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:21,161 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'employees_min']
2025-11-10 16:28:21,170 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'employees_min']
2025-11-10 16:28:22,424 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:22,443 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:22,461 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?employees_min=10 HTTP/1.1" 200 OK
2025-11-10 16:28:22,595 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:22,609 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'employees_max']
2025-11-10 16:28:22,627 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'employees_max']
2025-11-10 16:28:23,822 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:23,828 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:23,839 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?employees_max=100 HTTP/1.1" 200 OK
2025-11-10 16:28:23,915 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:23,933 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_min', 'distinct']
2025-11-10 16:28:23,939 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_min', 'distinct']
2025-11-10 16:28:25,133 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:25,152 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:25,181 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?annual_revenue_min=1000000 HTTP/1.1" 200 OK
2025-11-10 16:28:25,302 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:25,319 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_max', 'distinct']
2025-11-10 16:28:25,328 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_max', 'distinct']
2025-11-10 16:28:26,533 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:26,568 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:26,663 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?annual_revenue_max=10000000 HTTP/1.1" 200 OK
2025-11-10 16:28:26,950 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:26,982 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'total_funding_min']
2025-11-10 16:28:26,983 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'total_funding_min']
2025-11-10 16:28:28,254 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:28,273 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:28,276 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?total_funding_min=1000000 HTTP/1.1" 200 OK
2025-11-10 16:28:28,499 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:28,509 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'total_funding_max']
2025-11-10 16:28:28,523 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'total_funding_max']
2025-11-10 16:28:29,789 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:29,809 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:29,843 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?total_funding_max=50000000 HTTP/1.1" 200 OK
2025-11-10 16:28:30,015 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:30,032 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'latest_funding_amount_min']
2025-11-10 16:28:30,034 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'latest_funding_amount_min']
2025-11-10 16:28:31,266 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:31,321 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:31,358 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?latest_funding_amount_min=100000 HTTP/1.1" 200 OK
2025-11-10 16:28:31,585 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:31,599 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'latest_funding_amount_max']
2025-11-10 16:28:31,616 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'latest_funding_amount_max']
2025-11-10 16:28:33,010 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:33,092 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:33,176 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?latest_funding_amount_max=5000000 HTTP/1.1" 200 OK
2025-11-10 16:28:33,536 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:33,547 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_after', 'distinct']
2025-11-10 16:28:33,587 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_after', 'distinct']
2025-11-10 16:28:34,374 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:35,340 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:62197 - "GET /api/v1/contacts/?created_at_after=2024-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:39,499 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:39,516 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_before', 'distinct']
2025-11-10 16:28:39,538 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_before', 'distinct']
2025-11-10 16:28:40,352 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:40,440 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:57509 - "GET /api/v1/contacts/?created_at_before=2025-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:42,954 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:42,968 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'updated_at_after']
2025-11-10 16:28:42,983 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'updated_at_after']
2025-11-10 16:28:43,790 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:43,887 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:57513 - "GET /api/v1/contacts/?updated_at_after=2024-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at >= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:46,234 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:46,249 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'updated_at_before']
2025-11-10 16:28:46,263 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'updated_at_before']
2025-11-10 16:28:46,968 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:47,087 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:58403 - "GET /api/v1/contacts/?updated_at_before=2025-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.updated_at <= $1::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $2::INTEGER OFFSET $3::INTEGER]
[parameters: (datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:28:49,514 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:49,527 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'first_name']
2025-11-10 16:28:49,539 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'first_name']
2025-11-10 16:28:52,483 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:52,497 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:52,515 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?first_name=ann&country=US HTTP/1.1" 200 OK
2025-11-10 16:28:52,740 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:52,784 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'employees_min']
2025-11-10 16:28:52,845 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'employees_min']
2025-11-10 16:28:54,225 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:28:54,246 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:28:54,277 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?country=US&employees_min=50 HTTP/1.1" 200 OK
2025-11-10 16:28:54,518 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:54,541 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'industries', 'technologies']
2025-11-10 16:28:54,615 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'industries', 'technologies']
2025-11-10 16:28:56,933 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:28:56,962 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=2 has_next=False has_previous=False
2025-11-10 16:28:56,989 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?industry=software&technologies=python HTTP/1.1" 200 OK
2025-11-10 16:28:57,121 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:57,134 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email_status', 'stage']
2025-11-10 16:28:57,180 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'email_status', 'stage']
2025-11-10 16:28:59,392 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:28:59,426 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:28:59,447 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?email_status=valid&stage=lead HTTP/1.1" 200 OK
2025-11-10 16:28:59,569 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:28:59,580 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['city', 'country', 'distinct', 'state']
2025-11-10 16:28:59,594 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['city', 'country', 'distinct', 'state']
2025-11-10 16:29:03,789 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:03,805 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:03,842 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?country=US&state=CA&city=San HTTP/1.1" 200 OK
2025-11-10 16:29:03,935 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:03,962 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_min', 'distinct', 'employees_max', 'employees_min']
2025-11-10 16:29:03,972 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['annual_revenue_min', 'distinct', 'employees_max', 'employees_min']
2025-11-10 16:29:05,499 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:05,554 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:05,621 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?employees_min=50&employees_max=500&annual_revenue_min=1000000 HTTP/1.1" 200 OK
2025-11-10 16:29:05,776 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:05,820 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_after', 'distinct', 'updated_at_before']
2025-11-10 16:29:05,836 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['created_at_after', 'distinct', 'updated_at_before']
2025-11-10 16:29:06,590 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE AND contacts.updated_at <= $2::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $3::INTEGER OFFSET $4::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:29:06,633 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE AND contacts.updated_at <= $2::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $3::INTEGER OFFSET $4::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:58413 - "GET /api/v1/contacts/?created_at_after=2024-01-01T00%3A00%3A00Z&updated_at_before=2025-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 103, in list_contacts
    page = await service.list_contacts(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 148, in list_contacts
    rows = await self.repository.list_contacts(session, filters, limit, offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 370, in list_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT contacts.id, contacts.uuid, contacts.first_name, contacts.last_name, contacts.company_id, contacts.email, contacts.title, contacts.departments, contacts.mobile_phone, contacts.email_status, contacts.text_search, contacts.created_at, contacts.updated_at, contacts.seniority, company.id AS id_1, company.uuid AS uuid_1, company.name, company.employees_count, company.industries, company.keywords, company.address, company.annual_revenue, company.total_funding, company.technologies, company.text_search AS text_search_1, company.created_at AS created_at_1, company.updated_at AS updated_at_1, contact_metadata.id AS id_2, contact_metadata.uuid AS uuid_2, contact_metadata.linkedin_url, contact_metadata.facebook_url, contact_metadata.twitter_url, contact_metadata.website, contact_metadata.work_direct_phone, contact_metadata.home_phone, contact_metadata.city, contact_metadata.state, contact_metadata.country, contact_metadata.other_phone, contact_metadata.stage, company_metadata.id AS id_3, company_metadata.uuid AS uuid_3, company_metadata.linkedin_url AS linkedin_url_1, company_metadata.facebook_url AS facebook_url_1, company_metadata.twitter_url AS twitter_url_1, company_metadata.website AS website_1, company_metadata.company_name_for_emails, company_metadata.phone_number, company_metadata.latest_funding, company_metadata.latest_funding_amount, company_metadata.last_raised_at, company_metadata.city AS city_1, company_metadata.state AS state_1, company_metadata.country AS country_1
FROM contacts LEFT OUTER JOIN companies AS company ON contacts.company_id = company.uuid LEFT OUTER JOIN contacts_metadata AS contact_metadata ON contacts.uuid = contact_metadata.uuid LEFT OUTER JOIN companies_metadata AS company_metadata ON company.uuid = company_metadata.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE AND contacts.updated_at <= $2::TIMESTAMP WITHOUT TIME ZONE
 LIMIT $3::INTEGER OFFSET $4::INTEGER]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)), datetime.datetime(2025, 1, 1, 0, 0, tzinfo=TzInfo(0)), 25, 0)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:29:09,684 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:09,715 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['company', 'distinct', 'industries', 'keywords', 'technologies']
2025-11-10 16:29:09,756 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['company', 'distinct', 'industries', 'keywords', 'technologies']
2025-11-10 16:29:10,639 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:29:10,654 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:29:10,675 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?company=tech&industry=software&technologies=python&keywords=enterprise HTTP/1.1" 200 OK
2025-11-10 16:29:10,737 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:10,756 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:10,976 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:12,506 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:12,555 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:12,569 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=fintech HTTP/1.1" 200 OK
2025-11-10 16:29:12,614 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:12,626 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:12,636 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:13,849 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:13,855 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:13,862 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=tech HTTP/1.1" 200 OK
2025-11-10 16:29:13,891 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:13,899 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:13,905 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:14,659 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:14,666 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:14,669 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=software HTTP/1.1" 200 OK
2025-11-10 16:29:14,722 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:14,733 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:14,740 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:15,773 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:15,774 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:15,777 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=enterprise HTTP/1.1" 200 OK
2025-11-10 16:29:15,805 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:15,807 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:15,810 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:16,749 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:16,750 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:16,753 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=startup HTTP/1.1" 200 OK
2025-11-10 16:29:16,780 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:16,782 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:16,783 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:17,726 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:17,743 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:17,747 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=test HTTP/1.1" 200 OK
2025-11-10 16:29:17,791 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:17,803 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:17,803 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:29:52,592 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:52,639 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:29:52,669 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=example HTTP/1.1" 200 OK
2025-11-10 16:29:52,786 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:52,809 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size', 'search']
2025-11-10 16:29:52,905 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'page_size', 'search']
2025-11-10 16:29:53,749 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:53,773 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:29:53,830 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=tech&page=1&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:29:53,965 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:53,975 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:29:53,983 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:29:55,072 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:55,107 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:29:55,151 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=created_at&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:29:55,276 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:55,296 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:29:55,313 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:29:56,441 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:29:56,461 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:29:56,463 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-created_at&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:29:56,574 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:29:56,609 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:29:56,622 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:00,527 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:30:00,535 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:30:00,549 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=updated_at&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:30:00,606 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:30:00,620 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:00,644 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:04,184 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:30:04,205 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:30:04,235 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-updated_at&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:30:04,275 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:30:04,321 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:04,340 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:21,190 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:30:21,207 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:30:21,238 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=employees&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:30:21,302 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:30:21,334 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:21,345 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:37,695 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:30:37,707 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:30:37,734 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-employees&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:30:37,796 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:30:37,822 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:37,844 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:55,074 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:30:55,095 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:30:55,108 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=annual_revenue&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:30:55,174 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:30:55,189 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:30:55,203 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:12,245 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:31:12,343 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:31:12,345 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-annual_revenue&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:31:12,563 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:31:12,576 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:12,582 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:28,858 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:31:28,876 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:31:28,880 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=total_funding&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:31:28,976 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:31:29,006 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:29,032 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:47,411 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:31:47,417 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:31:47,419 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-total_funding&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:31:47,470 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:31:47,486 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:31:47,504 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:05,465 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:05,469 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:05,480 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=latest_funding_amount&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:05,532 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:05,541 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:05,555 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:23,924 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:23,937 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:23,980 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-latest_funding_amount&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:24,130 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:24,166 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:24,166 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:25,163 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:25,178 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:25,190 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=first_name&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:25,293 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:25,316 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:25,344 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:26,090 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:26,104 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:26,123 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-first_name&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:26,159 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:26,177 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:26,198 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:27,156 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:27,164 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:27,182 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=last_name&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:27,222 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:27,233 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:27,243 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:28,220 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:28,255 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:28,275 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-last_name&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:28,405 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:28,427 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:28,443 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:29,443 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:29,454 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:29,477 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=title&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:29,594 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:29,607 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:29,622 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:30,580 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:30,594 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:30,606 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-title&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:30,683 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:30,715 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:30,717 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:50,768 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:32:50,770 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:32:50,770 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=company&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:32:50,804 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:32:50,806 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:32:50,806 - app.services.contacts_service - INFO - Service listing contacts: limit=10 offset=0 use_cursor=False filters=['distinct', 'ordering', 'page_size']
2025-11-10 16:33:08,506 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:33:08,520 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=10 has_next=True has_previous=False
2025-11-10 16:33:08,534 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=-company&page_size=10 HTTP/1.1" 200 OK
2025-11-10 16:33:08,635 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:08,644 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'ordering']
2025-11-10 16:33:08,658 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'ordering']
2025-11-10 16:33:08,691 - app.services.contacts_service - WARNING - List contacts request rejected: Unknown ordering field: country
2025-11-10 16:33:08,706 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=400
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=country%2C-employees%2Ccreated_at HTTP/1.1" 400 Bad Request
2025-11-10 16:33:08,877 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:08,885 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'employees_min', 'ordering', 'page_size', 'search']
2025-11-10 16:33:08,921 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['country', 'distinct', 'employees_min', 'ordering', 'page_size', 'search']
2025-11-10 16:33:10,442 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:33:10,460 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:33:10,526 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search=tech&country=US&employees_min=50&ordering=-employees&page=1&page_size=25 HTTP/1.1" 200 OK
2025-11-10 16:33:10,685 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:10,718 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:33:10,796 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:33:11,809 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:33:11,830 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:33:11,853 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?search= HTTP/1.1" 200 OK
2025-11-10 16:33:11,991 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:12,015 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=100 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:33:12,015 - app.services.contacts_service - INFO - Service listing contacts: limit=100 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:33:13,461 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:33:13,517 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=100 has_next=True has_previous=False
2025-11-10 16:33:13,571 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?page_size=1000 HTTP/1.1" 200 OK
2025-11-10 16:33:13,705 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:13,728 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'ordering']
2025-11-10 16:33:13,754 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'ordering']
2025-11-10 16:33:13,795 - app.services.contacts_service - WARNING - List contacts request rejected: Unknown ordering field: invalid_field
2025-11-10 16:33:13,831 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=400
INFO:     127.0.0.1:65103 - "GET /api/v1/contacts/?ordering=invalid_field HTTP/1.1" 400 Bad Request
2025-11-10 16:33:13,933 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:33:13,944 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:33:13,966 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct', 'search']
2025-11-10 16:35:16,173 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:35:16,174 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:35:16,174 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:35:17,420 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:35:17,420 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:35:17,420 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/ HTTP/1.1" 200 OK
2025-11-10 16:35:17,440 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:35:17,440 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=1 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:35:17,440 - app.services.contacts_service - INFO - Service listing contacts: limit=1 offset=0 use_cursor=False filters=['distinct', 'page_size']
2025-11-10 16:35:21,311 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:35:21,313 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=1 has_next=True has_previous=False
2025-11-10 16:35:21,313 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/?page_size=1 HTTP/1.1" 200 OK
2025-11-10 16:35:21,322 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/5001/
2025-11-10 16:35:21,324 - app.api.v1.endpoints.contacts - INFO - Retrieving contact detail: contact_id=5001
2025-11-10 16:35:21,324 - app.services.contacts_service - INFO - Service retrieving contact: contact_id=5001
2025-11-10 16:35:22,050 - app.api.v1.endpoints.contacts - INFO - Retrieved contact detail: contact_id=5001
2025-11-10 16:35:22,050 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/5001/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/5001/ HTTP/1.1" 200 OK
2025-11-10 16:35:22,071 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/invalid/
2025-11-10 16:35:22,071 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/invalid/ status=404
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/invalid/ HTTP/1.1" 404 Not Found
2025-11-10 16:35:22,081 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/999999999/
2025-11-10 16:35:22,089 - app.api.v1.endpoints.contacts - INFO - Retrieving contact detail: contact_id=999999999
2025-11-10 16:35:22,089 - app.services.contacts_service - INFO - Service retrieving contact: contact_id=999999999
2025-11-10 16:35:22,916 - app.services.contacts_service - WARNING - Contact not found: contact_id=999999999
2025-11-10 16:35:23,241 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/999999999/ status=404
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/999999999/ HTTP/1.1" 404 Not Found
2025-11-10 16:35:23,247 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/-1/
2025-11-10 16:35:23,247 - app.api.v1.endpoints.contacts - INFO - Retrieving contact detail: contact_id=-1
2025-11-10 16:35:23,260 - app.services.contacts_service - INFO - Service retrieving contact: contact_id=-1
2025-11-10 16:35:23,793 - app.services.contacts_service - WARNING - Contact not found: contact_id=-1
2025-11-10 16:35:24,045 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/-1/ status=404
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/-1/ HTTP/1.1" 404 Not Found
2025-11-10 16:35:24,061 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/0/
2025-11-10 16:35:24,061 - app.api.v1.endpoints.contacts - INFO - Retrieving contact detail: contact_id=0
2025-11-10 16:35:24,061 - app.services.contacts_service - INFO - Service retrieving contact: contact_id=0
2025-11-10 16:35:24,514 - app.services.contacts_service - WARNING - Contact not found: contact_id=0
2025-11-10 16:35:24,733 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/0/ status=404
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/0/ HTTP/1.1" 404 Not Found
2025-11-10 16:35:24,749 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/5001/
2025-11-10 16:35:24,749 - app.api.v1.endpoints.contacts - INFO - Retrieving contact detail: contact_id=5001
2025-11-10 16:35:24,749 - app.services.contacts_service - INFO - Service retrieving contact: contact_id=5001
2025-11-10 16:35:25,218 - app.api.v1.endpoints.contacts - INFO - Retrieved contact detail: contact_id=5001
2025-11-10 16:35:25,234 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/5001/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/5001/ HTTP/1.1" 200 OK
2025-11-10 16:35:25,249 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:25,249 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct']
2025-11-10 16:35:25,249 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct']
2025-11-10 16:35:26,564 - app.services.contacts_service - INFO - Service counted contacts: total=2548891
2025-11-10 16:35:26,564 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct'] total=2548891
2025-11-10 16:35:26,564 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/ HTTP/1.1" 200 OK
2025-11-10 16:35:26,579 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:26,579 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['country', 'distinct']
2025-11-10 16:35:26,579 - app.services.contacts_service - INFO - Service counting contacts: filters=['country', 'distinct']
2025-11-10 16:35:27,768 - app.services.contacts_service - INFO - Service counted contacts: total=2548891
2025-11-10 16:35:27,768 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['country', 'distinct'] total=2548891
2025-11-10 16:35:27,768 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?country=US HTTP/1.1" 200 OK
2025-11-10 16:35:27,788 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:27,788 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct', 'employees_min']
2025-11-10 16:35:27,788 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct', 'employees_min']
2025-11-10 16:35:35,457 - app.services.contacts_service - INFO - Service counted contacts: total=1940993
2025-11-10 16:35:35,457 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct', 'employees_min'] total=1940993
2025-11-10 16:35:35,457 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?employees_min=50 HTTP/1.1" 200 OK
2025-11-10 16:35:35,474 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:35,474 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct', 'email_status']
2025-11-10 16:35:35,474 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct', 'email_status']
2025-11-10 16:35:38,561 - app.services.contacts_service - INFO - Service counted contacts: total=0
2025-11-10 16:35:38,561 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct', 'email_status'] total=0
2025-11-10 16:35:38,563 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?email_status=valid HTTP/1.1" 200 OK
2025-11-10 16:35:38,577 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:38,577 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct', 'industries']
2025-11-10 16:35:38,579 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct', 'industries']
2025-11-10 16:35:39,787 - app.services.contacts_service - INFO - Service counted contacts: total=261
2025-11-10 16:35:39,787 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct', 'industries'] total=261
2025-11-10 16:35:39,787 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?industry=software HTTP/1.1" 200 OK
2025-11-10 16:35:39,803 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:39,803 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['country', 'distinct', 'email_status', 'employees_min']
2025-11-10 16:35:39,803 - app.services.contacts_service - INFO - Service counting contacts: filters=['country', 'distinct', 'email_status', 'employees_min']
2025-11-10 16:35:44,169 - app.services.contacts_service - INFO - Service counted contacts: total=0
2025-11-10 16:35:44,169 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['country', 'distinct', 'email_status', 'employees_min'] total=0
2025-11-10 16:35:44,169 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?country=US&employees_min=50&email_status=valid HTTP/1.1" 200 OK
2025-11-10 16:35:44,185 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:35:44,185 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct', 'search']
2025-11-10 16:35:44,185 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct', 'search']
2025-11-10 16:37:01,381 - app.services.contacts_service - INFO - Service counted contacts: total=1616355
2025-11-10 16:37:01,382 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct', 'search'] total=1616355
2025-11-10 16:37:01,382 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?search=tech HTTP/1.1" 200 OK
2025-11-10 16:37:01,396 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:37:01,396 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['created_at_after', 'distinct']
2025-11-10 16:37:01,396 - app.services.contacts_service - INFO - Service counting contacts: filters=['created_at_after', 'distinct']
2025-11-10 16:37:02,086 - app.core.middleware - ERROR - Error processing request method=GET path=/api/v1/contacts/count/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 190, in count_contacts
    count = await service.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 200, in count_contacts
    total = await self.repository.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 410, in count_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT count(contacts.id) AS count_1
FROM contacts LEFT OUTER JOIN companies AS company_for_count ON contacts.company_id = company_for_count.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)),)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:37:02,096 - app.core.middleware - ERROR - Error during TimingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 190, in count_contacts
    count = await service.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 200, in count_contacts
    total = await self.repository.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 410, in count_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT count(contacts.id) AS count_1
FROM contacts LEFT OUTER JOIN companies AS company_for_count ON contacts.company_id = company_for_count.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)),)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
INFO:     127.0.0.1:55839 - "GET /api/v1/contacts/count/?created_at_after=2024-01-01T00%3A00%3A00Z HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 42, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\core\middleware.py", line 21, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 111, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 391, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\fastapi\routing.py", line 290, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\api\v1\endpoints\contacts.py", line 190, in count_contacts
    count = await service.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\services\contacts_service.py", line 200, in count_contacts
    total = await self.repository.count_contacts(session, filters)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\code\ayan\appoinmentbackend\app\repositories\contacts.py", line 410, in count_contacts
    result = await session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\durga\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2024, 1, 1, 0, 0, tzin... (can't subtract offset-naive and offset-aware datetimes)
[SQL: SELECT count(contacts.id) AS count_1
FROM contacts LEFT OUTER JOIN companies AS company_for_count ON contacts.company_id = company_for_count.uuid
WHERE contacts.created_at >= $1::TIMESTAMP WITHOUT TIME ZONE]
[parameters: (datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(0)),)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-11-10 16:37:04,165 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/
2025-11-10 16:37:04,167 - app.api.v1.endpoints.contacts - INFO - Counting contacts with filters=['distinct']
2025-11-10 16:37:04,167 - app.services.contacts_service - INFO - Service counting contacts: filters=['distinct']
2025-11-10 16:37:05,071 - app.services.contacts_service - INFO - Service counted contacts: total=2675864
2025-11-10 16:37:05,071 - app.api.v1.endpoints.contacts - INFO - Counted contacts: filters=['distinct'] total=2675864
2025-11-10 16:37:05,071 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/count/ status=200
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/count/ HTTP/1.1" 200 OK
2025-11-10 16:37:05,087 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:05,087 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,119 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:05,119 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,166 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:05,168 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,209 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:05,209 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,252 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:05,252 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,293 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:05,293 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,340 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:05,340 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,378 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:05,379 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,417 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:05,417 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,444 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:05,444 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,492 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:05,492 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,526 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:05,526 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,571 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:05,572 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,612 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:05,612 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,651 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:05,651 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,687 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:05,687 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,726 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:05,726 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,767 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:05,767 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,806 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:05,806 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,841 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:05,841 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,885 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:05,886 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,939 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:05,939 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:05,976 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:05,976 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,015 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:06,015 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?search=fintech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,054 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:06,054 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,090 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:06,090 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,130 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:06,130 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,171 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:06,171 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,212 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:06,212 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,259 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:06,259 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,308 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:06,308 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,354 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:06,354 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,395 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:06,395 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,442 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:06,443 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,481 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:06,481 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,524 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:06,524 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?search=tech HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,565 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:06,567 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,624 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:06,626 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,667 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:06,667 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,719 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:06,719 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,758 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:06,758 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,799 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:06,799 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,840 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:06,840 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,882 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:06,883 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,912 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:06,912 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:06,962 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:06,962 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,003 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:07,003 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,047 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:07,047 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?distinct=true HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,092 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:07,092 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,130 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:07,130 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,172 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:07,172 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,206 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:07,206 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,252 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:07,252 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,291 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:07,293 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,331 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:07,331 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,378 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:07,380 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,423 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:07,423 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,549 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:07,550 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,590 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:07,592 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,629 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:07,632 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?limit=10&offset=0 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,669 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:07,669 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,701 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:07,701 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,751 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:07,751 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,780 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:07,780 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,827 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:07,827 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,876 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:07,876 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,913 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:07,913 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,953 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:07,953 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:07,995 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:07,995 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,029 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:08,029 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,090 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:08,090 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,135 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:08,135 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?search=test&distinct=true&limit=10 HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,169 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:08,169 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,220 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:08,220 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,264 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:08,264 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,305 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:08,311 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,348 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:08,355 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,397 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:08,398 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,443 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:08,443 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,490 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:08,492 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,532 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:08,532 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,578 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:08,578 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,621 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:08,623 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,663 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:08,665 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/?search= HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,704 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/
2025-11-10 16:37:08,704 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/title/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/title/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,750 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/
2025-11-10 16:37:08,751 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,782 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/
2025-11-10 16:37:08,782 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/industry/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/industry/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,829 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/
2025-11-10 16:37:08,830 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/keywords/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/keywords/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,869 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/
2025-11-10 16:37:08,869 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/technologies/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/technologies/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,913 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/
2025-11-10 16:37:08,913 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/city/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,945 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/
2025-11-10 16:37:08,945 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/state/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:08,993 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/
2025-11-10 16:37:08,993 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/country/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,034 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/
2025-11-10 16:37:09,034 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_address/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_address/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,080 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/
2025-11-10 16:37:09,081 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_city/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_city/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,110 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/
2025-11-10 16:37:09,110 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_state/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_state/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,164 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/
2025-11-10 16:37:09,164 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/company_country/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/company_country/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,191 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/import/
2025-11-10 16:37:09,191 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/import/ status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/import/ HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,211 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/import
2025-11-10 16:37:09,220 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/import status=404
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/import HTTP/1.1" 404 Not Found
2025-11-10 16:37:09,338 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/admin/
2025-11-10 16:37:09,338 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/admin/ status=403
INFO:     127.0.0.1:63558 - "GET /admin/ HTTP/1.1" 403 Forbidden
2025-11-10 16:37:09,366 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=POST path=/api/v1/contacts/
2025-11-10 16:37:09,368 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=POST path=/api/v1/contacts/ status=403
INFO:     127.0.0.1:63558 - "POST /api/v1/contacts/ HTTP/1.1" 403 Forbidden
2025-11-10 16:37:09,384 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=PUT path=/api/v1/contacts/1/
2025-11-10 16:37:09,385 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=PUT path=/api/v1/contacts/1/ status=405
INFO:     127.0.0.1:63558 - "PUT /api/v1/contacts/1/ HTTP/1.1" 405 Method Not Allowed
2025-11-10 16:37:09,400 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=DELETE path=/api/v1/contacts/1/
2025-11-10 16:37:09,400 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=DELETE path=/api/v1/contacts/1/ status=405
INFO:     127.0.0.1:63558 - "DELETE /api/v1/contacts/1/ HTTP/1.1" 405 Method Not Allowed
2025-11-10 16:37:09,413 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:37:09,428 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=400
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/?created_at_after=invalid-date HTTP/1.1" 400 Bad Request
2025-11-10 16:37:09,443 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:37:09,443 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=400
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/?employees_min=not-a-number HTTP/1.1" 400 Bad Request
2025-11-10 16:37:09,459 - app.core.middleware - INFO - Entering LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/
2025-11-10 16:37:09,459 - app.api.v1.endpoints.contacts - INFO - Listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:37:09,459 - app.services.contacts_service - INFO - Service listing contacts: limit=25 offset=0 use_cursor=False filters=['distinct']
2025-11-10 16:37:10,374 - app.services.contacts_service - INFO - List contacts pagination prepared: next=True previous=False
2025-11-10 16:37:10,374 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=25 has_next=True has_previous=False
2025-11-10 16:37:10,376 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
INFO:     127.0.0.1:63558 - "GET /api/v1/contacts/ HTTP/1.1" 200 OK
2025-11-10 16:37:50,490 - app.services.contacts_service - INFO - List contacts pagination prepared: next=False previous=False
2025-11-10 16:37:50,490 - app.api.v1.endpoints.contacts - INFO - Listed contacts: returned=0 has_next=False has_previous=False
2025-11-10 16:37:50,506 - app.core.middleware - INFO - Exiting LoggingMiddleware.dispatch method=GET path=/api/v1/contacts/ status=200
